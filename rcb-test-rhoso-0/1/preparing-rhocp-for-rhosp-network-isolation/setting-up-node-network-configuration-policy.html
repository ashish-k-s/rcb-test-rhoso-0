<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Setting up Node Network Configuration Policy :: RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</title>
    <link rel="prev" href="preparing-rhocp-for-rhosp-network-isolation.html">
    <link rel="next" href="configuring-network-attachment-definition.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rcb-test-rhoso-0" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../introduction/introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/traditional-tripleo-deployment-versus-deployment-with-openshift-cluster.html">Traditional TripleO deployment versus deployment with OpenShift cluster.</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/rhoso-installation-process-overview.html">RHOSO installation process overview</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../prerequisites-for-installation/prerequisites-for-installation.html">Prerequisites for Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../prerequisites-for-installation/about-the-prerequisite-operators.html">About the Prerequisite Operators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../prerequisites-for-installation/install-nmstate-operator.html">Install NMState Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../prerequisites-for-installation/install-metallb-operator.html">Install MetalLB Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../prerequisites-for-installation/install-cert-manager-operator.html">Install Cert-Manager Operator</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="preparing-rhocp-for-rhosp-network-isolation.html">Preparing RHOCP for RHOSP Network Isolation</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="setting-up-node-network-configuration-policy.html">Setting up Node Network Configuration Policy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuring-network-attachment-definition.html">Configuring Network Attachment Definition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configure-metallb-ip-address-pools.html">Configure MetalLB IP Address Pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup-metallb-l2-advertisement-configuration.html">Setup MetalLB L2 Advertisement configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../storage/storage.html">Storage</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/configuring-nfs-storage.html">Configuring NFS storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/verify-storage-configuration.html">Verify storage configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install-control-plane/install-control-plane.html">Install control plane</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/configure-the-secrets.html">Configure the secrets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/install-the-openstack-operator.html">Install the OpenStack Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/create-the-openstack-control-plane.html">Create the OpenStack Control Plane</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/troubleshoot-the-openstack-control-plane.html">Troubleshoot the OpenStack Control Plane</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/verify-openstack-control-plane-configuration.html">Verify OpenStack control plane configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../create-data-plane/create-data-plane.html">Create data plane</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/create-the-data-plane-network-configuration.html">Create the Data Plane Network configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/create-the-data-plane-vm.html">Create the Data Plane VM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/data-plane-deployment.html">Data Plane Deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/troubleshoot-the-data-plane-deployment.html">Troubleshoot the Data Plane deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/verify-data-plane-deployment.html">Verify data plane deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../access-openstack/access-openstack.html">Access OpenStack</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../access-openstack/steps-to-access-openstack.html">Steps to Access OpenStack</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a></li>
    <li><a href="preparing-rhocp-for-rhosp-network-isolation.html">Preparing RHOCP for RHOSP Network Isolation</a></li>
    <li><a href="setting-up-node-network-configuration-policy.html">Setting up Node Network Configuration Policy</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Setting up Node Network Configuration Policy</h1>
<h1 id="_rhosp18_provision_control_plane_services_and_manage_data_plane_nodes" class="sect0"><a class="anchor" href="#_rhosp18_provision_control_plane_services_and_manage_data_plane_nodes"></a>RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</h1>
<div class="sect1">
<h2 id="_preparing_rhocp_for_rhosp_network_isolation"><a class="anchor" href="#_preparing_rhocp_for_rhosp_network_isolation"></a>Preparing RHOCP for RHOSP Network Isolation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Setting up Node Network Configuration Policy</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Node Network Configuration Policy (NNCP) is a crucial component in configuring network settings for nodes within the Red Hat OpenShift Container Platform (RHOCP), ensuring proper isolation and communication for your Red Hat OpenStack Platform (RHOSP) deployment. NNCPs provide a declarative way to configure networking on Red Hat OpenShift nodes, allowing you to manage network configurations across bare-metal and virtual machine environments consistently.</p>
</div>
<div class="sect2">
<h3 id="_step_1_install_nmstate_operator"><a class="anchor" href="#_step_1_install_nmstate_operator"></a>Step 1: Install NMState Operator</h3>
<div class="paragraph">
<p>Before setting up the Node Network Configuration Policy, ensure that you have installed the NMState Operator in your RHOCP environment. The NMState Operator enables you to define and manage the desired state of the network configuration on OpenShift nodes using the <code>nmstate</code> project.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Access your Red Hat OpenShift cluster as a user with the 'cluster-admin' role.</p>
</li>
<li>
<p>Navigate to the OperatorHub and search for "NMState".</p>
</li>
<li>
<p>Click "Install" on the NMState Operator tile, select an appropriate subscription and approval strategy, and confirm the installation.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_create_nncp_yaml_files"><a class="anchor" href="#_step_2_create_nncp_yaml_files"></a>Step 2: Create NNCP YAML Files</h3>
<div class="paragraph">
<p>Once the NMState Operator is installed, create YAML files that define your desired network configuration using the <code>nncp</code> resource. These YAML files will configure interfaces, routes, firewall rules, and other networking settings on each node in your RHOCP cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Example NNCP for a single interface:</strong></p>
<div class="literalblock">
<div class="content">
<pre>```yaml
apiVersion: nmstate.io/v1alpha1
kind: NodeNetworkConfigurationPolicy
metadata:
  name: my-nncp
spec:
  state: desired
  desiredConfig:
    interfaces:
      - name: ens3
        description: "Management Interface"
        type: ethernet
        state: up
        mtu: 1500
        ethernet:
          macAddress: "AA:BB:CC:DD:EE:FF"
        ipv4:
          address:
            - ip: 192.168.1.10/24
              method: static
          dhcp4: false
        ipv6:
          enabled: true
          method: auto
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Apply the NNCP:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Apply your NNCP YAML file to your RHOCP cluster using `oc apply`:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
oc apply -f &lt;nncp-file&gt;.yaml
```</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_monitor_nncp_status"><a class="anchor" href="#_step_3_monitor_nncp_status"></a>Step 3: Monitor NNCP Status</h3>
<div class="paragraph">
<p>After applying the NNCP, you can monitor its status and ensure that all nodes conform to the specified configuration.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check NNCP status:</p>
<div class="literalblock">
<div class="content">
<pre>```bash
oc get nncp my-nncp -o yaml
```</pre>
</div>
</div>
</li>
<li>
<p>List NNCP events:</p>
<div class="literalblock">
<div class="content">
<pre>```bash
oc describe nncp my-nncp
```</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_troubleshoot_nncp_configuration_issues"><a class="anchor" href="#_step_4_troubleshoot_nncp_configuration_issues"></a>Step 4: Troubleshoot NNCP Configuration Issues</h3>
<div class="paragraph">
<p>If you encounter issues with your Node Network Configuration Policy, consult the following common troubleshooting steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Inspect node status:</strong> Use <code>oc get nodes</code> to check the readiness and conditions of your OpenShift nodes to identify any networking-related problems.</p>
</li>
<li>
<p><strong>Review NMState logs:</strong> Examine the NMState Operator logs for clues about configuration failures, using commands such as:</p>
<div class="literalblock">
<div class="content">
<pre>```bash
oc logs &lt;nmstate-operator-pod-name&gt; -n openshift-nmstate
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Adjust and reapply NNCP:</strong> Modify your NNCP YAML file according to the issues identified in the logs or node status, then reapply it with <code>oc apply</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>By setting up Node Network Configuration Policies correctly, you ensure that your Red Hat OpenShift Container Platform nodes are appropriately configured for networking, enabling a stable foundation for your Red Hat OpenStack Platform deployment. Remember to adapt these instructions according to your specific network requirements and environment setup.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="preparing-rhocp-for-rhosp-network-isolation.html">Preparing RHOCP for RHOSP Network Isolation</a></span>
  <span class="next"><a href="configuring-network-attachment-definition.html">Configuring Network Attachment Definition</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
