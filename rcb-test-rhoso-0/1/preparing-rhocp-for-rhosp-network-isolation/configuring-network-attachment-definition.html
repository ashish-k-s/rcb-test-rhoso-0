<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configuring Network Attachment Definition :: RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</title>
    <link rel="prev" href="setting-up-node-network-configuration-policy.html">
    <link rel="next" href="configure-metallb-ip-address-pools.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rcb-test-rhoso-0" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../introduction/introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/traditional-tripleo-deployment-versus-deployment-with-openshift-cluster.html">Traditional TripleO deployment versus deployment with OpenShift cluster.</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/rhoso-installation-process-overview.html">RHOSO installation process overview</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../prerequisites-for-installation/prerequisites-for-installation.html">Prerequisites for Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../prerequisites-for-installation/about-the-prerequisite-operators.html">About the Prerequisite Operators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../prerequisites-for-installation/install-nmstate-operator.html">Install NMState Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../prerequisites-for-installation/install-metallb-operator.html">Install MetalLB Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../prerequisites-for-installation/install-cert-manager-operator.html">Install Cert-Manager Operator</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="preparing-rhocp-for-rhosp-network-isolation.html">Preparing RHOCP for RHOSP Network Isolation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setting-up-node-network-configuration-policy.html">Setting up Node Network Configuration Policy</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="configuring-network-attachment-definition.html">Configuring Network Attachment Definition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configure-metallb-ip-address-pools.html">Configure MetalLB IP Address Pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup-metallb-l2-advertisement-configuration.html">Setup MetalLB L2 Advertisement configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../storage/storage.html">Storage</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/configuring-nfs-storage.html">Configuring NFS storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/verify-storage-configuration.html">Verify storage configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install-control-plane/install-control-plane.html">Install control plane</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/configure-the-secrets.html">Configure the secrets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/install-the-openstack-operator.html">Install the OpenStack Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/create-the-openstack-control-plane.html">Create the OpenStack Control Plane</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/troubleshoot-the-openstack-control-plane.html">Troubleshoot the OpenStack Control Plane</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../install-control-plane/verify-openstack-control-plane-configuration.html">Verify OpenStack control plane configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../create-data-plane/create-data-plane.html">Create data plane</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/create-the-data-plane-network-configuration.html">Create the Data Plane Network configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/create-the-data-plane-vm.html">Create the Data Plane VM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/data-plane-deployment.html">Data Plane Deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/troubleshoot-the-data-plane-deployment.html">Troubleshoot the Data Plane deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-data-plane/verify-data-plane-deployment.html">Verify data plane deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../access-openstack/access-openstack.html">Access OpenStack</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../access-openstack/steps-to-access-openstack.html">Steps to Access OpenStack</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a></li>
    <li><a href="preparing-rhocp-for-rhosp-network-isolation.html">Preparing RHOCP for RHOSP Network Isolation</a></li>
    <li><a href="configuring-network-attachment-definition.html">Configuring Network Attachment Definition</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Configuring Network Attachment Definition</h1>
<h1 id="_rhosp18_provision_control_plane_services_and_manage_data_plane_nodes" class="sect0"><a class="anchor" href="#_rhosp18_provision_control_plane_services_and_manage_data_plane_nodes"></a>RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</h1>
<div class="sect1">
<h2 id="_preparing_rhocp_for_rhosp_network_isolation"><a class="anchor" href="#_preparing_rhocp_for_rhosp_network_isolation"></a>Preparing RHOCP for RHOSP Network Isolation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>&#8230;&#8203;</p>
</div>
</div>
</div>
<h1 id="_configuring_network_attachment_definition" class="sect0"><a class="anchor" href="#_configuring_network_attachment_definition"></a>Configuring Network Attachment Definition</h1>
<div class="paragraph">
<p>In Red Hat OpenShift (RHOCP), the Network Attachment Definition (NAD) is a custom resource that allows you to define and request additional network interfaces on your nodes. These additional interfaces can be used for various purposes, such as connecting to external networks or implementing advanced networking configurations like VLANs or bonding.</p>
</div>
<div class="paragraph">
<p>For Red Hat OpenShift Container Platform (RHOCP) preparation in a Red Hat OpenStack Platform (RHOSP) environment with network isolation, you need to configure the Network Attachment Definitions properly before proceeding with control plane and data plane services installation. Here’s a step-by-step guide on how to accomplish this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Create a YAML file for Network Attachment Definition:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Begin by creating a YAML file that defines your desired network interface configuration. This file will request additional interfaces (also called "secondary" or "subinterfaces") on your RHOCP worker nodes when they are deployed on RHOSP. An example NAD YAML configuration for a VLAN interface could look like this:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```yaml
apiVersion: "k8s.cni.cncf.io/v1"
kind: NetworkAttachmentDefinition
metadata:
  name: my-vlan-nad
spec:
  config: |
    {
      "cniVersion": "0.3.1",
      "name": "my-vlan-net",
      "type": "vlan",
      "vlanId": 100,
      "ipam": {
        "type": "host-local",
        "subnet": "192.168.1.0/24"
      }
    }
```</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>In this example, a VLAN interface with ID 100 is created on each worker node, using the subnet `192.168.1.0/24`.</pre>
</div>
</div>
</li>
<li>
<p><strong>Apply the Network Attachment Definition:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Use `kubectl` to apply your YAML configuration to RHOCP:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
kubectl apply -f my-vlan-nad.yaml
```</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>This command will create the specified Network Attachment Definition in your RHOCP cluster.</pre>
</div>
</div>
</li>
<li>
<p><strong>Verify the Network Attachment Definition:</strong></p>
<div class="literalblock">
<div class="content">
<pre>To ensure that the NAD was successfully created, you can list all NetworkAttachmentDefinitions using:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```bash
kubectl get networkattachmentdefinitions
```</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>You should see your newly created "my-vlan-nad" listed among other default or existing NADs.</pre>
</div>
</div>
</li>
<li>
<p><strong>Configure Node Network Configuration Policy:</strong></p>
<div class="literalblock">
<div class="content">
<pre>With the Network Attachment Definition in place, proceed to configure the Node Network Configuration Policy (NNCP). This policy ensures that when RHOCP nodes are created on your RHOSP infrastructure, they will have the desired additional network interfaces based on the NAD you defined earlier.</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>By following these steps, you ensure that RHOCP nodes deployed on RHOSP not only receive the primary management and service interfaces but also the additional interfaces specified in the Network Attachment Definition, facilitating proper network isolation and enhanced connectivity options for your OpenStack control plane and data plane services.</p>
</div>
<nav class="pagination">
  <span class="prev"><a href="setting-up-node-network-configuration-policy.html">Setting up Node Network Configuration Policy</a></span>
  <span class="next"><a href="configure-metallb-ip-address-pools.html">Configure MetalLB IP Address Pools</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
